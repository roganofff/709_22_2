--1 task Вывести модели часов, которые начали продаваться в 2023 году и не закончили продаваться, и оценкой от 4 до 5.

select model
from product_5on po 
where po.sales_start = 2023 and po.sales_end is null and po.category = 'часы' and (po.score >= 4 and po.score <= 5);

--2 task Вывести названия компаний (НЕ брендов), поставляющих ноутбуки на операционной системе Linux, но не на Windows.

select name
from provider_p0q pr
join provider_product_info_exu pp on pp.provider_id = pr.id 
join product_5on po on pp.product_id = po.id
where po.os = 'Linux' and po.category = 'ноутбуки'
except 
select name
from provider_p0q pr
join provider_product_info_exu pp on pp.provider_id = pr.id 
join product_5on po on pp.product_id = po.id
where po.os = 'Windows' and po.category = 'ноутбуки';

--3 task Вывести названия компаний, поставляющие как электронные книги, так и часы.

select name
from provider_p0q pr
join provider_product_info_exu pp on pp.provider_id = pr.id 
join product_5on po on pp.product_id = po.id
where po.category = 'электронные книги'
intersect 
select name
from provider_p0q pr
join provider_product_info_exu pp on pp.provider_id = pr.id 
join product_5on po on pp.product_id = po.id
where po.category = 'часы';

--4 task Вывести названия компаний, поставляющих продукцию бренда Apple либо имеющие транспортные средства с грузоподъемностью от 25.

select name
from provider_p0q pr
join provider_transport_info_lt2 pt on pt.provider_id = pr.id 
join transport_oaz tr on pt.transport_id = tr.id 
where tr.lifting_capacity >= 25
union 
select name
from provider_p0q pr
join provider_product_info_exu pp on pp.provider_id = pr.id
join product_5on po on pp.product_id = po.id
where po.brand = 'Apple';

--5 task Вывести минимальный, максимальный вес, среднюю цену и суммарную стоимость (price * quantity) ноутбуков бренда MSI.

select max(weight), avg(price), sum(price * quantity)
from provider_product_info_exu pp
join product_5on po on po.id = pp.product_id 
where po.brand = 'MSI' and po.category = 'ноутбуки';

--6 task Вывести модели ноутбуков с наибольшим размером экрана и наименьшим весом среди ноутбуков с наибольшим размером экрана.

with models_max_size as (with models_screen_weight as (
select model, screen_size, weight
from product_5on po 
where po.category = 'ноутбуки')
select *
from models_screen_weight
where screen_size = (select max(screen_size) from models_screen_weight))

select model
from models_max_size 
where weight = (select min(weight) from models_max_size);

--7 task Вывести количество различных брендов в бд.

with brands as (select distinct brand from product_5on po)
select count(brand) from brands;




